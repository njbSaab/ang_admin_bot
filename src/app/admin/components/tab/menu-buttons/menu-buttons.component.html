<section class="menu-buttons bg-main-trans-gradient-0 pb-[30px]">
  <div
    class="bg-main-trans2-gradient-90 header-tab flex items-center justify-between px-[20px] py-[10px] my-[30px] rounded-[20px] w-[70%] mx-auto"
  >
    <h2 class="title-tab text-xl text-main-trans font-bold">
      Главные кнопки меню
    </h2>
    <p
      class="text-right flex gap-2 items-center rounded-[20px] bg-main px-[15px] py-[5px]"
    >
      Всего кнопок:
      <span class="font-bold text-2xl">{{ menuTables.length }}</span>
    </p>
  </div>

  <!-- Сообщения об успехе и ошибках -->
  <div
    *ngIf="successMessage"
    class="alert alert-success relative flex justify-between mb-4"
  >
    <b>{{ successMessage }}</b>
    <span class="close" (click)="closeMessages()">✖</span>
  </div>

  <div *ngIf="errorMessage" class="alert alert-error relative mb-4">
    {{ errorMessage }}
    <span class="close" (click)="closeMessages()">✖</span>
  </div>

  <div *ngFor="let table of menuTables" class="w-[80%] mx-auto">
    <div *ngIf="!table.isEditing">
      <div
        class="collapse collapse-arrow card-body bg-reg my-4 rounded-xl p-[20px] pb-[10px]"
      >
        <input
          type="radio"
          class="collapse collapse-close"
          name="my-accordion-3"
          checked="checked"
        />
        <div class="collapse-title text-xl font-medium">
          <h3>
            <span class="text-indigo-600 pr-2">{{ table.order }}</span
            >{{ table.name }}
          </h3>
        </div>
        <div class="collapse-content px-0">
          <div class="flex justify-between pb-4 items-center">
            <span class="nj-toast text-sm">
              Level buttons menu: {{ table.parentId || 1 }}
            </span>
            <p class="text-end text-gray-400 text-xs flex-auto">
              Last update {{ table.updated_at | date: "medium" }}
            </p>
          </div>

          <div class="menu-post-item mb-[40px]">
            <h3
              class="nj-border text-xl text-indigo-600 font-bold py-4 text-center"
            >
              After click the button
            </h3>

            <div class="card bg-base-100 mx-auto w-[80%] shadow-xl">
              <figure *ngIf="table.linked_post?.post_image_url">
                <img
                  [src]="table.linked_post?.post_image_url"
                  alt="Post Image"
                />
              </figure>
              <div class="card-body">
                <p class="text-indigo-600">ID: {{ table.linked_post?.id }}</p>
                <h3 class="text-xl text-indigo-400 font-bold">
                  {{ table.linked_post?.post_title }}
                </h3>
                <p>{{ table.linked_post?.post_content }}</p>
                <div class="card-actions justify-center pt-[20px]">
                  <!-- <button class="btn btn-ghost pr-0" disabled>
                    Редактировать
                    <span class="btn btn-primary">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="30"
                        height="30"
                        viewBox="0 0 24 24"
                      >
                        <g
                          fill="none"
                          stroke="currentColor"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                        >
                          <path
                            stroke-dasharray="20"
                            stroke-dashoffset="20"
                            d="M3 21h18"
                          >
                            <animate
                              fill="freeze"
                              attributeName="stroke-dashoffset"
                              dur="0.2s"
                              values="20;0"
                            />
                          </path>
                          <path
                            fill="currentColor"
                            fill-opacity="0"
                            stroke-dasharray="48"
                            stroke-dashoffset="48"
                            d="M7 17v-4l10 -10l4 4l-10 10h-4"
                          >
                            <animate
                              fill="freeze"
                              attributeName="fill-opacity"
                              begin="1.1s"
                              dur="0.5s"
                              values="0;1"
                            />
                            <animate
                              fill="freeze"
                              attributeName="stroke-dashoffset"
                              begin="0.2s"
                              dur="0.6s"
                              values="48;0"
                            />
                          </path>
                          <path
                            stroke-dasharray="8"
                            stroke-dashoffset="8"
                            d="M14 6l4 4"
                          >
                            <animate
                              fill="freeze"
                              attributeName="stroke-dashoffset"
                              begin="0.8s"
                              dur="0.2s"
                              values="8;0"
                            />
                          </path>
                        </g>
                      </svg>
                    </span>
                  </button> -->
                </div>
              </div>
            </div>
          </div>

          <div class="btn-wrapper flex justify-end">
            <button class="btn btn-ghost pr-0" (click)="toggleEdit(table)">
              Редактировать
              <span class="btn btn-primary">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="30"
                  height="30"
                  viewBox="0 0 24 24"
                >
                  <g
                    fill="none"
                    stroke="currentColor"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                  >
                    <path
                      stroke-dasharray="20"
                      stroke-dashoffset="20"
                      d="M3 21h18"
                    >
                      <animate
                        fill="freeze"
                        attributeName="stroke-dashoffset"
                        dur="0.2s"
                        values="20;0"
                      />
                    </path>
                    <path
                      fill="currentColor"
                      fill-opacity="0"
                      stroke-dasharray="48"
                      stroke-dashoffset="48"
                      d="M7 17v-4l10 -10l4 4l-10 10h-4"
                    >
                      <animate
                        fill="freeze"
                        attributeName="fill-opacity"
                        begin="1.1s"
                        dur="0.5s"
                        values="0;1"
                      />
                      <animate
                        fill="freeze"
                        attributeName="stroke-dashoffset"
                        begin="0.2s"
                        dur="0.6s"
                        values="48;0"
                      />
                    </path>
                    <path
                      stroke-dasharray="8"
                      stroke-dashoffset="8"
                      d="M14 6l4 4"
                    >
                      <animate
                        fill="freeze"
                        attributeName="stroke-dashoffset"
                        begin="0.8s"
                        dur="0.2s"
                        values="8;0"
                      />
                    </path>
                  </g>
                </svg>
              </span>
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      *ngIf="table.isEditing"
      class="collapse collapse-plus card-body bg-reg my-4 rounded-xl p-[20px] pb-[10px]"
    >
      <label class="block text-sm text-indigo-400 font-bold"
        >Название кнопки:</label
      >
      <input
        [(ngModel)]="table.name"
        class="input w-full mt-2 mb-4 border border-gray-300 rounded-lg px-4 py-2.5 focus:ring focus:ring-blue-300 focus:ring-opacity-40"
        placeholder="Введите заголовок"
      />
      <label class="block text-sm text-indigo-400 font-bold"
        >Позиция кнопки №</label
      >
      <input
        disabled
        [(ngModel)]="table.order"
        class="input w-full mt-2 mb-4 border border-gray-300 rounded-lg px-4 py-2.5 focus:ring focus:ring-blue-300 focus:ring-opacity-40"
        placeholder="Введите заголовок"
      />

      <label class="block text-sm text-indigo-400 font-bold"
        >Контент поста:</label
      >
      <textarea
        disabled
        [(ngModel)]="table.description"
        class="w-full h-40 border rounded-lg px-4 py-2 focus:ring focus:ring-blue-300 focus:ring-opacity-40"
        placeholder="Введите контент поста"
      ></textarea>

      <div class="card-actions justify-center pt-4">
        <button class="btn pr-0 text-success" (click)="saveChanges(table)">
          Сохранить
          <span class="btn btn-accent">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="30"
              height="30"
              viewBox="0 0 24 24"
            >
              <path
                fill="none"
                stroke="#fff"
                stroke-dasharray="24"
                stroke-dashoffset="24"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2.7"
                d="M5 11l6 6l10 -10"
              >
                <animate
                  fill="freeze"
                  attributeName="stroke-dashoffset"
                  dur="0.96s"
                  values="24;0"
                />
              </path>
            </svg>
          </span>
        </button>
      </div>
    </div>
  </div>
</section>
